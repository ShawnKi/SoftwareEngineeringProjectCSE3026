{% extends "base.html" %}

{% block head %}
<title>Quiz</title>
<style>
  .center-screen {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 80vh;
  }
</style>
{% endblock %}

{% block body %}
<div class="container center-screen">
  <div class="card p-3">
    <h2>Fitness Tracking App Survey</h2>

    <form id="surveyForm">
      <div id="section1">
      <label for="goal">What's your goal?</label><br>
      <input type="radio" id="getFit" name="goal" value="Get fit">
      <label for="getFit">Get fit</label><br>
      <input type="radio" id="loseWeight" name="goal" value="Lose weight">
      <label for="loseWeight">Lose weight</label><br>
      <input type="radio" id="buildMuscle" name="goal" value="Build muscle">
      <label for="buildMuscle">Build muscle</label><br>
      <button type="button" onclick="showSection(2)">Next</button>
      </div>

      <!-- Second set of questions (initially hidden) -->
      <div id="section2" style="display: none;">
        <label for="physique">What's your goal physique?</label><br>
        <input type="radio" id="athletic" name="physique" value="Athletic">
        <label for="athletic">Athletic</label><br>
        <input type="radio" id="muscular" name="physique" value="Muscular">
        <label for="muscular">Muscular</label><br>
        <input type="radio" id="cutLean" name="physique" value="Cut/Lean">
        <label for="cutLean">Cut/Lean</label><br>
        <button type="button" onclick="showSection(1)">Previous</button>
        <button type="button" onclick="showSection(3)">Next</button> 
      </div>
      
      <div id="section3" style="display: none;">   
        <label for="bodyType">What's your body type?</label><br>
        <input type="radio" id="ectomorph" name="bodyType" value="Ectomorph">
        <label for="ectomorph">Ectomorph</label><br>
        <input type="radio" id="mesomorph" name="bodyType" value="Mesomorph">
        <label for="mesomorph"0>Mesomorph</label><br>
        <input type="radio" id="endomorph" name="bodyType" value="Endomorph">
        <label for="endomorph">Endomorph</label><br>
        <button type="button" onclick="showSection(2)">Previous</button>
        <button type="button" onclick="showSection(4)">Next</button> 
      </div>

      <div id="section4" style="display: none;">
        <label for="exerciseFrequency">How often do you exercise?</label><br>
        <input type="radio" id="onceAWeek" name="exerciseFrequency" value="Once a week">
        <label for="onceAWeek">Once a week</label><br>
        <input type="radio" id="twiceAWeek" name="exerciseFrequency" value="Twice a week">
        <label for="twiceAWeek">Twice a week</label><br>
        <input type="radio" id="threeTimesAWeek" name="exerciseFrequency" value="Three times a week">
        <label for="threeTimesAWeek">Three times a week</label><br>
        <input type="radio" id="fourOrFiveTimesAWeek" name="exerciseFrequency" value="4-5 times a week">
        <label for="fourOrFiveTimesAWeek">4-5 times a week</label><br>
        <button type="button" onclick="showSection(3)">Previous</button>
        <button type="button" onclick="showSection(5)">Next</button> 
      </div>

      <div id="section5" style="display: none;">
        <label for="equipment">Which equipment do you have?</label><br>
        <input type="checkbox" id="noEquipment" name="equipment" value="No equipment">
        <label for="noEquipment">No equipment</label><br>
        <input type="checkbox" id="dumbbells" name="equipment" value="Dumbbells">
        <label for="dumbbells">Dumbbells</label><br>
        <input type="checkbox" id="pullUpBar" name="equipment" value="Pull-up bar">
        <label for="pullUpBar">Pull-up bar</label><br>
        <input type="checkbox" id="barbell" name="equipment" value="Barbell">
        <label for="barbell">Barbell</label><br>
        <input type="checkbox" id="kettlebell" name="equipment" value="Kettlebell">
        <label for="kettlebell">Kettlebell</label><br>
        <button type="button" onclick="showSection(4)">Previous</button> 
        <button type="button" onclick="showSection(6)">Next</button> 
      </div> 

      <div id="section6" style="display: none;">
        <label for="dietaryPreferences">What are your dietary preferences?</label><br>
        <input type="checkbox" id="vegetarian" name="dietaryPreferences" value="Vegetarian">
        <label for="vegetarian">Vegetarian</label><br>
        <input type="checkbox" id="vegan" name="dietaryPreferences" value="Vegan">
        <label for="vegan">Vegan</label><br>
        <input type="checkbox" id="glutenFree" name="dietaryPreferences" value="Gluten Free">
        <label for="glutenFree">Gluten Free</label><br>
        <input type="checkbox" id="lactoseFree" name="dietaryPreferences" value="Lactose Free">
        <label for="lactoseFree">Lactose Free</label><br>
        <input type="checkbox" id="kosher" name="dietaryPreferences" value="Kosher">
        <label for="kosher">Kosher</label><br>
        <button type="button" onclick="showSection(5)">Previous</button> 
        <button type="button" onclick="showSection(7)">Next</button> 
      </div>

      <div id="section7" style="display: none;">
        <label for="height">What's your height(cm)?</label><br>
        <input type="number" id="height" name="personal" value=""> <br>
        <label for="weight">How much you weigh(lb)?</label><br>
        <input type="number" id="weight" name="personal" value=""><br>
        <label for="goalweight">What's your goal weight(lb)?</label><br>
        <input type="number" id="goalweight" name="personal" value=""><br><br>
        <button type="button" onclick="showSection(6)">Previous</button> 
        <button type="submit">Submit</button>
      </div>
    <!-- Navigation buttons --> 
      <!--a href="quiz1" target="btn blue">Submit</a></p>-->
      <!-- Add the rest of your questions in a similar manner -->
    </form>
  </div>
</div>
<script>
  function showSection(sectionNumber) {
      // Hide all sections
      document.querySelectorAll('[id^="section"]').forEach(section => {
          section.style.display = 'none';
      });
      // Show the selected section
      document.getElementById(`section${sectionNumber}`).style.display = 'block';
  }
</script>

<script>
  document.getElementById("surveyForm").addEventListener("submit", function (event) {
    event.preventDefault()

    let result = {
      goal: document.querySelector('input[name="goal"]:checked').value,
      bodyType: document.querySelector('input[name="bodyType"]:checked').value,
      equipment : document.querySelector('input[name="equipment"]:checked').value,
      personal : document.querySelector('input[name="personal"]:checked').value,
      exerciseFrequency : document.querySelector('input[name="exerciseFrequency"]:checked').value,
      dietaryPreferences: Array.from(document.querySelectorAll('input[name="dietaryPreferences"]:checked')).map(el => el.value),
      // Add the rest of your variables in a similar manner
    };

    fetch('/quiz', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(result)
    }).then(response => {
      if (response.ok) {
        window.location.href = "/thankyou";  // Redirect to the "thank you" page
      } else {
        throw new Error('Error: ' + response.statusText);
      }
    }).catch(error => {
      console.error('Error:', error);
    });
  });
</script>
{% endblock %}